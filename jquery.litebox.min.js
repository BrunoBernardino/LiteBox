// liteBox v2.0 by Bruno Bernardino | 2013.03.23 | https://github.com/BrunoBernardino/LiteBox
(function(){var e,t,n;t={generateID:function(){var e;e=function(){return((1+window.Math.random())*65536|0).toString(16).substring(1)};return(e()+e()+"-"+e()+"-4"+e().substr(0,3)+"-"+e()+"-"+e()+e()+e()).toLowerCase()}};e={galleries:[],currentGallery:"",currentGalleryIndex:-1,options:{}};n={init:function(t){var r;r={liteboxID:"litebox",backgroundClass:"litebox-background",wrapperClass:"litebox-wrapper",contentClass:"litebox-content",closeButtonClass:"litebox-close",arrowButtonClass:"litebox-arrow",leftArrowButtonAddedClass:"left",rightArrowButtonAddedClass:"right",liteboxMainTemplateID:"templates-litebox",liteboxImageTemplateID:"templates-litebox-image",liteboxIFrameTemplateID:"templates-litebox-iframe",liteboxHTMLTemplateID:"templates-litebox-html",htmlClass:"html",isModal:false,escapeCloses:true,arrowKeysNavigate:true,animationType:"fade",animationSpeed:"fast",openOnComplete:$.noop,dataLitebox:"liteboxItemOptions"};t=$.extend(r,t);e.options=$.extend({},t);n.create.call(this,t);return this.each(function(){var r,i,s,o,u,a;r=$(this);i=r.data("litebox");if(!i){u={gallery:"",alt:"",type:"image"};a=$.extend(u,r.data(t.dataLitebox));s=-1;if(a.gallery.length>0){if(!$.isArray(e.galleries[a.gallery])){e.galleries[a.gallery]=[]}o={src:r.attr("href"),alt:a.alt};s=e.galleries[a.gallery].push(o)-1}r.data("litebox",{target:r,options:a,galleryIndex:s});return $(this).on("click.litebox",function(e){e.preventDefault();return n.open.call(this,t)})}})},destroy:function(){$(window).off(".litebox");return this.each(function(){var e,t;e=$(this);t=e.data("litebox");return e.removeData("litebox")})},create:function(t){var r;if(typeof t==="undefined"){t=e.options}if($("#"+t.liteboxID).length>0){return false}else{r=_.template($("#"+t.liteboxMainTemplateID).html(),{liteboxID:t.liteboxID,backgroundClass:t.backgroundClass,wrapperClass:t.wrapperClass,closeButtonClass:t.closeButtonClass,arrowButtonClass:t.arrowButtonClass,leftArrowButtonAddedClass:t.leftArrowButtonAddedClass,rightArrowButtonAddedClass:t.rightArrowButtonAddedClass,contentClass:t.contentClass});$("body").append(r);if(t.escapeCloses){$(document).on("keydown.litebox",function(e){if(e.keyCode===27){e.preventDefault();return n.close.call(this,t)}})}if(!t.isModal){$("#"+t.liteboxID+"-background").on("click.litebox",function(e){return n.close.call(this,t)})}if(t.arrowKeysNavigate){$(document).on("keydown.litebox",function(e){if(e.keyCode===37){e.preventDefault();return n.navigateLeft.call(this,t)}else if(e.keyCode===39){e.preventDefault();return n.navigateRight.call(this,t)}})}$("#"+t.liteboxID+" ."+t.arrowButtonClass).on("click.litebox",function(e){e.preventDefault();if($(this).hasClass(t.leftArrowButtonAddedClass)){return n.navigateLeft.call(this,t)}else{if($(this).hasClass(t.rightArrowButtonAddedClass)){return n.navigateRight.call(this,t)}}});$("#"+t.liteboxID+" ."+t.closeButtonClass).on("click.litebox",function(e){e.preventDefault();return n.close.call(this,t)});return $(window).on("resize.litebox",function(e){return n.positionOnCenter.call(this,t)})}},open:function(t){var r,i,s,o,u,a,f;r=$(this);i=r.data("litebox");u=i.options;o=i.galleryIndex;if(typeof t==="undefined"){t=e.options}if(!i){return false}$("#"+t.liteboxID+"-background").fadeIn("fast");s=function(){switch(u.type){case"iframe":return n.showIFrame.call(this,t,r.attr("href"));case"html":return n.showHTML.call(this,t,r.attr("href"));default:return n.showImage.call(this,t,u.gallery,o,r.attr("href"),u.alt)}};switch(t.animationType){case"slide":a=$("#"+t.liteboxID).css("margin-top");return $("#"+t.liteboxID).css({"margin-top":($("#"+t.liteboxID).outerHeight()*2+window.parseInt($("#"+t.liteboxID).css("top"),10))*-1+"px",display:"block",opacity:0}).animate({"margin-top":a,opacity:1},t.animationSpeed,s);case"zoom":f=$("#"+t.liteboxID).css("zoom");return $("#"+t.liteboxID).css({zoom:f/3,display:"block",opacity:0}).animate({zoom:f,opacity:1},t.animationSpeed,s);default:return $("#"+t.liteboxID).fadeIn(t.animationSpeed,s)}},close:function(t){if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}$("#"+t.liteboxID).fadeOut("fast",function(){return $("#"+t.liteboxID+"-content").empty()});$("#"+t.liteboxID+"-background").fadeOut("fast");e.currentGallery="";e.currentGalleryIndex=-1;return $("#"+t.liteboxID+" ."+t.arrowButtonClass).hide()},positionOnCenter:function(t){var n,r,i,s,o;if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}if($("#"+t.liteboxID).length>0){r=0;n=0;s=-5;i=-5;o=[];while(window.Math.abs(r-s)>1||window.Math.abs(n-i)>1){s=r;i=n;r=$("#"+t.liteboxID).outerWidth();n=$("#"+t.liteboxID).outerHeight();o.push($("#"+t.liteboxID).css({"margin-left":r/2*-1+"px","margin-top":n/2*-1+"px"}))}return o}},showOrHideArrows:function(t,n,r){if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}if(n.length>1){if(r>=0){$("#"+t.liteboxID+" ."+t.arrowButtonClass).show();if(r===e.galleries[n].length-1){$("#"+t.liteboxID+" ."+t.arrowButtonClass+"."+t.rightArrowButtonAddedClass).hide()}if(r===0){return $("#"+t.liteboxID+" ."+t.arrowButtonClass+"."+t.leftArrowButtonAddedClass).hide()}}}},showImage:function(r,i,s,o,u){var a;if(typeof r==="undefined"){r=e.options}if(!$("#"+r.liteboxID).length){return false}a=new Image;a.onload=function(){var f,l;f=t.generateID.call(this);l=_.template($("#"+r.liteboxImageTemplateID).html(),{liteboxID:r.liteboxID,generatedID:f,imageSrc:o,imageAlt:u});$("#"+r.liteboxID+"-content").html(l);n.positionOnCenter.call(this,r);e.currentGallery=i;e.currentGalleryIndex=s;n.showOrHideArrows.call(this,r,i,s);a.onload=function(){};if($.isFunction(r.openOnComplete)){return r.openOnComplete.call(this,r)}};return a.src=o},navigateTo:function(t,r){if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}if(e.galleries[e.currentGallery][r]){return n.showImage.call(this,t,e.currentGallery,r,e.galleries[e.currentGallery][r].src,e.galleries[e.currentGallery][r].alt)}},navigateLeft:function(t){var r;if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}if(e.currentGallery.length>0){r=e.currentGalleryIndex-1;if(r<0){return false}return n.navigateTo.call(this,t,r)}},navigateRight:function(t){var r;if(typeof t==="undefined"){t=e.options}if(!$("#"+t.liteboxID).length){return false}if(e.currentGallery.length>0){r=e.currentGalleryIndex+1;if(r>e.galleries[e.currentGallery].length-1){return false}return n.navigateTo.call(this,t,r)}},showIFrame:function(r,i){var s,o;if(typeof r==="undefined"){r=e.options}s=t.generateID.call(this);o=_.template($("#"+r.liteboxIFrameTemplateID).html(),{liteboxID:r.liteboxID,generatedID:s,iframeURL:i});$("#"+r.liteboxID+"-content").html(o);n.positionOnCenter.call(this,r);if($.isFunction(r.openOnComplete)){return r.openOnComplete.call(this,r)}},showHTML:function(r,i){var s,o;if(typeof r==="undefined"){r=e.options}o=t.generateID.call(this);s=_.template($("#"+r.liteboxHTMLTemplateID).html(),{liteboxID:r.liteboxID,generatedID:o,htmlClass:r.htmlClass,htmlContent:$(i).html()});$("#"+r.liteboxID+"-content").html(s);n.positionOnCenter.call(this,r);if($.isFunction(r.openOnComplete)){return r.openOnComplete.call(this,r)}}};$.fn.litebox=function(e){if(n[e]){return n[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return n.init.apply(this,arguments)}else{return $.error("Method "+e+" does not exist on jQuery.litebox")}}}).call(this)